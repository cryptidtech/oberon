package oberon

import (
	"bytes"
	"github.com/stretchr/testify/require"
	"testing"
)

func TestHashToCurve(t *testing.T) {
	testVectors := [][]byte{
		bytes.Repeat([]byte{0}, 16),
		bytes.Repeat([]byte{1}, 16),
		bytes.Repeat([]byte{2}, 16),
	}
	testExp := [][]byte{
		{172, 138, 253, 253, 253, 194, 82, 104, 59, 43, 38, 180, 176, 186, 155, 12, 51, 128, 241, 15, 122, 17, 6, 240, 63, 239, 30, 31, 84, 126, 192, 19, 97, 7, 220, 175, 181, 204, 66, 68, 85, 233, 178, 62, 125, 74, 138, 35},
		{177, 41, 50, 159, 138, 238, 193, 134, 118, 241, 151, 69, 210, 132, 242, 141, 205, 137, 44, 226, 1, 197, 170, 198, 129, 153, 21, 149, 108, 135, 129, 252, 119, 198, 71, 58, 101, 136, 252, 113, 190, 70, 167, 165, 160, 238, 128, 255},
		{133, 29, 101, 21, 224, 217, 72, 134, 140, 38, 141, 32, 109, 145, 150, 252, 67, 150, 121, 117, 158, 12, 192, 250, 121, 159, 163, 42, 217, 239, 254, 95, 180, 165, 25, 45, 14, 153, 122, 129, 14, 49, 229, 17, 230, 193, 218, 69},
	}

	for i, v := range testVectors {
		p, err := hashToCurve(v)
		require.NoError(t, err)
		require.Equal(t, testExp[i], p.ToAffineCompressed())
	}
}
